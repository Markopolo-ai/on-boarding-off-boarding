{"ast":null,"code":"import { endpoint } from '@octokit/endpoint';\nimport { getUserAgent } from 'universal-user-agent';\nimport { isPlainObject } from 'is-plain-object';\nimport nodeFetch from 'node-fetch';\nimport { RequestError } from '@octokit/request-error';\nconst VERSION = \"5.4.14\";\n\nfunction getBufferResponse(response) {\n  return response.arrayBuffer();\n}\n\nfunction fetchWrapper(requestOptions) {\n  if (isPlainObject(requestOptions.body) || Array.isArray(requestOptions.body)) {\n    requestOptions.body = JSON.stringify(requestOptions.body);\n  }\n\n  let headers = {};\n  let status;\n  let url;\n  const fetch = requestOptions.request && requestOptions.request.fetch || nodeFetch;\n  return fetch(requestOptions.url, Object.assign({\n    method: requestOptions.method,\n    body: requestOptions.body,\n    headers: requestOptions.headers,\n    redirect: requestOptions.redirect\n  }, requestOptions.request)).then(response => {\n    url = response.url;\n    status = response.status;\n\n    for (const keyAndValue of response.headers) {\n      headers[keyAndValue[0]] = keyAndValue[1];\n    }\n\n    if (status === 204 || status === 205) {\n      return;\n    } // GitHub API returns 200 for HEAD requests\n\n\n    if (requestOptions.method === \"HEAD\") {\n      if (status < 400) {\n        return;\n      }\n\n      throw new RequestError(response.statusText, status, {\n        headers,\n        request: requestOptions\n      });\n    }\n\n    if (status === 304) {\n      throw new RequestError(\"Not modified\", status, {\n        headers,\n        request: requestOptions\n      });\n    }\n\n    if (status >= 400) {\n      return response.text().then(message => {\n        const error = new RequestError(message, status, {\n          headers,\n          request: requestOptions\n        });\n\n        try {\n          let responseBody = JSON.parse(error.message);\n          Object.assign(error, responseBody);\n          let errors = responseBody.errors; // Assumption `errors` would always be in Array format\n\n          error.message = error.message + \": \" + errors.map(JSON.stringify).join(\", \");\n        } catch (e) {// ignore, see octokit/rest.js#684\n        }\n\n        throw error;\n      });\n    }\n\n    const contentType = response.headers.get(\"content-type\");\n\n    if (/application\\/json/.test(contentType)) {\n      return response.json();\n    }\n\n    if (!contentType || /^text\\/|charset=utf-8$/.test(contentType)) {\n      return response.text();\n    }\n\n    return getBufferResponse(response);\n  }).then(data => {\n    return {\n      status,\n      url,\n      headers,\n      data\n    };\n  }).catch(error => {\n    if (error instanceof RequestError) {\n      throw error;\n    }\n\n    throw new RequestError(error.message, 500, {\n      headers,\n      request: requestOptions\n    });\n  });\n}\n\nfunction withDefaults(oldEndpoint, newDefaults) {\n  const endpoint = oldEndpoint.defaults(newDefaults);\n\n  const newApi = function (route, parameters) {\n    const endpointOptions = endpoint.merge(route, parameters);\n\n    if (!endpointOptions.request || !endpointOptions.request.hook) {\n      return fetchWrapper(endpoint.parse(endpointOptions));\n    }\n\n    const request = (route, parameters) => {\n      return fetchWrapper(endpoint.parse(endpoint.merge(route, parameters)));\n    };\n\n    Object.assign(request, {\n      endpoint,\n      defaults: withDefaults.bind(null, endpoint)\n    });\n    return endpointOptions.request.hook(request, endpointOptions);\n  };\n\n  return Object.assign(newApi, {\n    endpoint,\n    defaults: withDefaults.bind(null, endpoint)\n  });\n}\n\nconst request = withDefaults(endpoint, {\n  headers: {\n    \"user-agent\": `octokit-request.js/${VERSION} ${getUserAgent()}`\n  }\n});\nexport { request };","map":{"version":3,"sources":["../dist-src/version.js","../dist-src/get-buffer-response.js","../dist-src/fetch-wrapper.js","../dist-src/with-defaults.js","../dist-src/index.js"],"names":["getBuffer"],"mappings":"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","sourcesContent":["export const VERSION = \"5.4.14\";\n","export default function getBufferResponse(response) {\n    return response.arrayBuffer();\n}\n","import { isPlainObject } from \"is-plain-object\";\nimport nodeFetch from \"node-fetch\";\nimport { RequestError } from \"@octokit/request-error\";\nimport getBuffer from \"./get-buffer-response\";\nexport default function fetchWrapper(requestOptions) {\n    if (isPlainObject(requestOptions.body) ||\n        Array.isArray(requestOptions.body)) {\n        requestOptions.body = JSON.stringify(requestOptions.body);\n    }\n    let headers = {};\n    let status;\n    let url;\n    const fetch = (requestOptions.request && requestOptions.request.fetch) || nodeFetch;\n    return fetch(requestOptions.url, Object.assign({\n        method: requestOptions.method,\n        body: requestOptions.body,\n        headers: requestOptions.headers,\n        redirect: requestOptions.redirect,\n    }, requestOptions.request))\n        .then((response) => {\n        url = response.url;\n        status = response.status;\n        for (const keyAndValue of response.headers) {\n            headers[keyAndValue[0]] = keyAndValue[1];\n        }\n        if (status === 204 || status === 205) {\n            return;\n        }\n        // GitHub API returns 200 for HEAD requests\n        if (requestOptions.method === \"HEAD\") {\n            if (status < 400) {\n                return;\n            }\n            throw new RequestError(response.statusText, status, {\n                headers,\n                request: requestOptions,\n            });\n        }\n        if (status === 304) {\n            throw new RequestError(\"Not modified\", status, {\n                headers,\n                request: requestOptions,\n            });\n        }\n        if (status >= 400) {\n            return response\n                .text()\n                .then((message) => {\n                const error = new RequestError(message, status, {\n                    headers,\n                    request: requestOptions,\n                });\n                try {\n                    let responseBody = JSON.parse(error.message);\n                    Object.assign(error, responseBody);\n                    let errors = responseBody.errors;\n                    // Assumption `errors` would always be in Array format\n                    error.message =\n                        error.message + \": \" + errors.map(JSON.stringify).join(\", \");\n                }\n                catch (e) {\n                    // ignore, see octokit/rest.js#684\n                }\n                throw error;\n            });\n        }\n        const contentType = response.headers.get(\"content-type\");\n        if (/application\\/json/.test(contentType)) {\n            return response.json();\n        }\n        if (!contentType || /^text\\/|charset=utf-8$/.test(contentType)) {\n            return response.text();\n        }\n        return getBuffer(response);\n    })\n        .then((data) => {\n        return {\n            status,\n            url,\n            headers,\n            data,\n        };\n    })\n        .catch((error) => {\n        if (error instanceof RequestError) {\n            throw error;\n        }\n        throw new RequestError(error.message, 500, {\n            headers,\n            request: requestOptions,\n        });\n    });\n}\n","import fetchWrapper from \"./fetch-wrapper\";\nexport default function withDefaults(oldEndpoint, newDefaults) {\n    const endpoint = oldEndpoint.defaults(newDefaults);\n    const newApi = function (route, parameters) {\n        const endpointOptions = endpoint.merge(route, parameters);\n        if (!endpointOptions.request || !endpointOptions.request.hook) {\n            return fetchWrapper(endpoint.parse(endpointOptions));\n        }\n        const request = (route, parameters) => {\n            return fetchWrapper(endpoint.parse(endpoint.merge(route, parameters)));\n        };\n        Object.assign(request, {\n            endpoint,\n            defaults: withDefaults.bind(null, endpoint),\n        });\n        return endpointOptions.request.hook(request, endpointOptions);\n    };\n    return Object.assign(newApi, {\n        endpoint,\n        defaults: withDefaults.bind(null, endpoint),\n    });\n}\n","import { endpoint } from \"@octokit/endpoint\";\nimport { getUserAgent } from \"universal-user-agent\";\nimport { VERSION } from \"./version\";\nimport withDefaults from \"./with-defaults\";\nexport const request = withDefaults(endpoint, {\n    headers: {\n        \"user-agent\": `octokit-request.js/${VERSION} ${getUserAgent()}`,\n    },\n});\n"]},"metadata":{},"sourceType":"module"}